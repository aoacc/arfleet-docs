<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-learn-arfleet/deal-lifecycle" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Lifecycle of a Deal | ArFleet Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.arfleet.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.arfleet.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.arfleet.io/docs/learn-arfleet/deal-lifecycle"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lifecycle of a Deal | ArFleet Docs"><meta data-rh="true" name="description" content="Here&#x27;s a high-level view of the lifecycle of an ArFleet deal:"><meta data-rh="true" property="og:description" content="Here&#x27;s a high-level view of the lifecycle of an ArFleet deal:"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.arfleet.io/docs/learn-arfleet/deal-lifecycle"><link data-rh="true" rel="alternate" href="https://docs.arfleet.io/docs/learn-arfleet/deal-lifecycle" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.arfleet.io/docs/learn-arfleet/deal-lifecycle" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ArFleet Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ArFleet Docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.3c3b7c49.css">
<script src="/assets/js/runtime~main.f2c598dd.js" defer="defer"></script>
<script src="/assets/js/main.264c58a5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="ArFleet Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="ArFleet Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ArFleet Docs</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/home">Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/use-arfleet">Use ArFleet</a><button aria-label="Expand sidebar category &#x27;Use ArFleet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/learn-arfleet">Learn ArFleet</a><button aria-label="Collapse sidebar category &#x27;Learn ArFleet&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-arfleet/protocol">ArFleet Protocol</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/learn-arfleet/deal-lifecycle">Lifecycle of a Deal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-arfleet/replica-encryption">Replica Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn-arfleet/verification-game">Verification Game</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/maintain-arfleet">Maintain ArFleet</a><button aria-label="Expand sidebar category &#x27;Maintain ArFleet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/learn-arfleet"><span itemprop="name">Learn ArFleet</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lifecycle of a Deal</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lifecycle of a Deal</h1></header>
<p>Here&#x27;s a high-level view of the lifecycle of an ArFleet deal:</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="assignments-and-placements">Assignments and Placements<a href="#assignments-and-placements" class="hash-link" aria-label="Direct link to Assignments and Placements" title="Direct link to Assignments and Placements">​</a></h2>
<p>When a user of ArFleet client software wants certain data stored, they queue it for storage. This is called a <strong>Storage Assignment</strong>, a storage job for the client.</p>
<p>Along with the pointer to the data to store, they specify to the client software:</p>
<ul>
<li>How much they are willing to pay for the storage.</li>
<li>The duration of the storage.</li>
<li>The redundancy factor they desire for their data to have (meaning how many copies of the data they want to be stored).</li>
</ul>
<p>It is the client&#x27;s job to match the storage assignment with providers based on the requirements, provider&#x27;s availability, provider&#x27;s capacity, and so on.</p>
<p>When a potential match between an Assignment and Provider is found, this is called a <strong>Storage Placement</strong>.</p>
<p>The goal is for each Assignment to have <em>N</em> successful Placements, where <em>N</em> is the redundancy factor of the Assignment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="marketplace">Marketplace<a href="#marketplace" class="hash-link" aria-label="Direct link to Marketplace" title="Direct link to Marketplace">​</a></h2>
<p>Clients have to find providers on the decentralized network. This could be done in a variety of ways; for convenience, ArFleet network designates a global <em>ao</em> process called <strong>Marketplace</strong>, which is used only as a place to discover providers and their services.</p>
<p>Providers use Marketplace to advertise their services to the network.</p>
<p>They can create, update and delete <strong>Announcements</strong>, which contain, at minimum:</p>
<ul>
<li>the version of the ArFleet protocol they are using.</li>
<li>connection information (Arweave wallet address, acting as the provider&#x27;s ID, and IP address/port pairs).</li>
<li>the prices they offer for storage.</li>
<li>the duration limits placed on new deals.</li>
<li>the verification challenge duration limits placed on new deals.</li>
</ul>
<p>Clients query Marketplace to find providers that meet their storage assignment requirements.</p>
<p>It is not a guarantee that such providers are:</p>
<ul>
<li>online</li>
<li>they still have the capacity to accept new storage assignments</li>
<li>they haven&#x27;t changed their announcement recently.</li>
</ul>
<p>Therefore, it is the client&#x27;s responsibility to directly contact the providers to verify their availability and capacity. Once a suitable provider is identified, a placement is initiated and progresses through several stages.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="placement-states">Placement States<a href="#placement-states" class="hash-link" aria-label="Direct link to Placement States" title="Direct link to Placement States">​</a></h2>
<p>The following is an ideal progression of a placement. Throughout this process, error handling is in place. If any step fails, the placement status may change to <code>FAILED</code> or <code>UNAVAILABLE</code>, depending on the nature of the error (<code>FAILED</code> meaning something went wrong with the steps, and <code>UNAVAILABLE</code> meaning the provider couldn&#x27;t be reached or stopped responding).</p>
<ol>
<li>
<p><strong>Creation</strong>: A new placement is created with the status <code>CREATED</code>.</p>
</li>
<li>
<p><strong>Initialization</strong>:</p>
<ul>
<li>The client connects to the provider and sends a placement request.</li>
<li>If accepted, the status changes to <code>INITIALIZED</code>.</li>
<li>The client starts encrypting the data chunks.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>To find more about the encryption process, see the <a href="/docs/learn-arfleet/replica-encryption">Replica Encryption</a> section.</p></div></div>
</li>
<li>
<p><strong>Encryption</strong>:</p>
<ul>
<li>All data chunks are encrypted.</li>
<li>A Merkle tree is calculated for the encrypted chunks.</li>
<li>The status changes to <code>ENCRYPTED</code>.</li>
</ul>
</li>
<li>
<p><strong>Process Spawning</strong>:</p>
<ul>
<li>An <em>ao</em> process is created for the deal, based on known Module source code, adjusted for the deal parameters.</li>
<li>The status changes to <code>PROCESS_SPAWNED</code>.</li>
</ul>
</li>
<li>
<p><strong>Funding</strong>:</p>
<ul>
<li>The client funds the deal with the required reward.</li>
<li>The status changes to <code>FUNDED</code>.</li>
</ul>
</li>
<li>
<p><strong>Acceptance</strong>:</p>
<ul>
<li>The provider is notified to accept the funded deal.</li>
<li>If accepted, the status changes to <code>ACCEPTED</code>. At this point, the deal is atomically activated from both sides.</li>
</ul>
</li>
<li>
<p><strong>Data Transfer</strong>:</p>
<ul>
<li>Encrypted data chunks are transferred to the provider.</li>
<li>Once all chunks are sent, the status changes to <code>TRANSFERRED</code>.</li>
</ul>
</li>
<li>
<p><strong>Completion</strong>:</p>
<ul>
<li>The provider is requested to complete the deal setup.</li>
<li>The provider sends the required collateral.</li>
<li>The <em>ao</em> process is verified to be in the &quot;Activated&quot; state.</li>
<li>If successful, the status changes to <code>COMPLETED</code>.</li>
</ul>
</li>
</ol>
<p>This concludes the placement part, and the verifications start.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="verification-challenges">Verification Challenges<a href="#verification-challenges" class="hash-link" aria-label="Direct link to Verification Challenges" title="Direct link to Verification Challenges">​</a></h2>
<p>After the deal is activated, the provider has to provide verification challenges to the deal process, for the duration of the deal.</p>
<p>For each verification challenge, the deal process generates a random bit string of &quot;0&quot;s and &quot;1&quot;s.</p>
<p>This string establishes a Merkle path to the chunk that the provider has to provide for verification. &quot;0&quot; means &quot;go left at this branch&quot; and &quot;1&quot; means &quot;go right at this branch&quot;; this continues until the provider hits a leaf, then the rest of the string is discarded.</p>
<p>The provider has to provide as verification proof:</p>
<ul>
<li>The Merkle path to the chunk (the actual hashes on each level).</li>
<li>The chunk data.</li>
</ul>
<p>The deal process verifies the path, starting with the root hash which is part of the deal contract, and down until the leaf. If the provided leaf data matches the hash, the challenge is considered as passed.</p>
<p>If the verification is unsuccessful, part of the provider&#x27;s collateral is slashed.</p>
<p>If the provider fails to present the proof within the verification period, part of the provider&#x27;s collateral is slashed.</p>
<p>Multiple consecutive failures can result in complete forfeiture of the collateral. This mechanism incentivizes Providers to maintain data integrity and adhere to the agreed-upon storage terms.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>To see why this verification game is effective despite only requiring a small chunk at each verification step, see <a href="/docs/learn-arfleet/verification-game">Verification Game</a> section.</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/learn-arfleet/protocol"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">ArFleet Protocol</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/learn-arfleet/replica-encryption"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Replica Encryption</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#assignments-and-placements" class="table-of-contents__link toc-highlight">Assignments and Placements</a></li><li><a href="#marketplace" class="table-of-contents__link toc-highlight">Marketplace</a></li><li><a href="#placement-states" class="table-of-contents__link toc-highlight">Placement States</a></li><li><a href="#verification-challenges" class="table-of-contents__link toc-highlight">Verification Challenges</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/aoacc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/vYctEs7aTd" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/aoaccorg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://arfleet.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://aoacc.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">ao/acc Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 ao/acc</div></div></div></footer></div>
</body>
</html>